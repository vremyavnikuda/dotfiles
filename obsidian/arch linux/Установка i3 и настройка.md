#полезное #archlinux

```zsh
sudo pacman -S xorg-server xorg-xinit i3-gaps i3status dmenu
```

После установки создадим и отредактируем файл ~/.xinitrc, записав в него текст “exec i3”
```zsh
echo 'exec i3' >> ~/.xinitrc
```

Эта инструкция при запуске графического сервера xorg запустит наш i3wm
И наконец, впервые запустим наш i3!
```zsh
startx
```
---
### Горячие клавиши

- **mod + Enter** - запустить терминал
- **mod + d** - запустить dmenu для запуска любой программы
- **mod + Shift + q** - закрыть активное окно программы
- **mod + 1, mod + 2, mod + …n** - переключение рабочих столов от 1 до 9
- **mod + Shift + 1, mod + Shift + … n** - перемещение активного окна на другой рабочий стол
- **mod + Shift + … ←, →, ↑, ↓** - изменение положения окон в рамках рабочего стола
- **mod + r** - ресайз активного окна
- **mod + Shift + c** - перечитать конфиг
- **mod + Shift + r** - перезапуск i3
- **mod + Shift + e** - выход из i3 с подтверждением
- **mod + Shift + space** - перевод окна в плавающий режим
---
Установим запуск firefox на сочетание горячих клавиш `mod + F1` (файл `~/.config/i3/config`)

```zsh
bindsym $mod + F1 exec firefox
```

Заменим dmenu на аналог rofi. Концептуально ничего нового, просто rofi мне больше нравится тем, что расположен не в баре, а плавающей строкой

```zsh
sudo pacman -S rofi
```

Чтобы задействовать его вместо dmenu найдем в конфиге строку

```zsh
bindsym $mod+d exec dmenu_run
```

и заменим ее на

```zsh
bindsym $mod+d exec --no-startup-id rofi -show run
```

`rofi` имеет множество встроенных тем, посмотреть и выбрать подходящую для себя можно утилитой `rofi-theme-selector`, запустив ее в терминале. После выбранную тему установить как параметр -theme <имя_темы> в строке запуска в конфиге. Также шрифт я выбрал hack 10, Вы же можете использовать подходящий Вам шрифт.

---
### Разрешение монитора, второй монитор
Пропишу в конфиге i3

```zsh
exec xrandr --output eDP-1 --mode 1920x1200 --pos 0x0 
exec xrandr --output HDMI-2 --mode 1920x1080 --pos 1920x0
```


### Установим обои на рабочий стол

```zsh
sudo pacman -S nitrogen
```

Запустим nitrogen, настроим обои, и поставим ее на автозапуск

```zsh
exec --no-startup-id nitrogen
```

### Установим compton

`compton` - легкий композитный менеджер для графического сервера X. Нам он нужен в первую очередь для устранения тиринга, если таковой присутствует, а также для создания небольших эффектов плавности переключения рабочих столов, чтобы было повеселее.

>К слову о тиринге: способы его устранения для разных производителей видеокарт разнятся, и гуглится это на раз два (пример запроса: **tearfree Nvidia**, или **AMD**, или **Intel**). Устраняется в основном путем конфигурирования xorg.

У меня видеокарта Intel, и тиринг изначально на i3wm есть. Но `compton` решает данную проблему, без необходимости правки конфигов xorg.

На момент написания статьи из `pacman` и `aur` исчез пакет `compton`. Глубоко не искал, но наткнулся на информацию, что `compton` теперь стал `picom` (в других источниках написано, что `compton` это форк `picom`). Вообщем устанавливаем `picom`, а запускаем `compton` (может `compton` теперь лишь симлинк, проверим позже)

```zsh
sudo pacman -S picom
```

В одном из конфигов он был установлен вместе с nitrogen в одну строку, так тому и быть

```zsh
exec --no-startup-id nitrogen --restore; sleep 1; compton -b
```

Из моментально заметных изменений - это плавность переключения рабочих столов, а также поддержка прозрачности некоторых окон. Если тиринг не ушел, то можно попробовать переключить в конфиге `backend` на `glx`. По умолчанию шаблон конфига лежит в файле `/etc/xdg/picom.conf.example`. Для его кастомизации скопируйте его в домашнюю директорию следующей командой

```zsh
mkdir -p ~/.config/picom && \ cp /etc/xdg/picom.conf.example ~/.config/picom/picom.conf
```

Свой же последний конфиг я наглухо скопировал с этого репозитория [https://github.com/dikiaap/dotfiles](https://github.com/dikiaap/dotfiles/blob/b034fc16b7e7a735587f9c1ae14e2ae8eccaff39/.picom/picom.conf). Все плавно и красиво.

О том, как сделать прозрачным терминал я расскажу в отдельной статье по [настройкам alacritty](https://igancev.ru/2020-04-18-terminal-emulator-alacritty). О более глубокой настройке compton можете погуглить.

### Цветовая температура экрана

Регулировать автоматическое переключение цветовой гаммы в более теплые тона будем программой `redshift`. Подробнее [о redshift на archwiki](https://wiki.archlinux.org/index.php/Redshift_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)). Я же буду краток. Ставим на автозагрузку в конфиг i3wm команду:

```zsh
exec --no-startup-id redshift -b 1.0:0.7 -t 6500:3200 -l 45:39
```

где:

- **-b 1.0:0.7** уровень яркости _день:ночь_
- **-t 6500:3200** цветовая температура _день:ночь_
- -l 45:39 укороченные координаты местонахождения latitude:longitude (ширина:долгота). [Узнать свои координаты](https://www.latlong.net/)

### Звук

Если не установили [на этапе первичной настройки arch linux](https://igancev.ru/2019-12-15-initial-configuration-of-arch-linux), то установим сейчас графическую утилиту для настройки звука `pavucontrol`

```zsh
sudo pacman -S pavucontrol
```

### Bluetooth

Для того, чтобы работал bluetooth, необходимо установить ряд утилит

```
sudo pacman -S bluez bluez-utils pulseaudio-bluetooth blueman
```

из которых `blueman` - графическая утилита

Для ее запуска наберем в rofi или dmenu `blueman-applet`, после чего увидим в трее иконку bluetooth с выпадающим по клику контекстным меню.

А кому по душе больше настройка bluetooth из командной строки необходимо набрать команду `bluetoothctl`, и затем `help`.

Но прежде чем подключать устройства, проверим запущена ли у нас служба `bluetooth.service`, и запустим, если не запущена:

```
# проверка
sudo systemctl status bluetooth.service

# запуск
sudo systemctl start bluetooth.service

# включение службы для автозапуска
sudo systemctl enable bluetooth.service
```

#### Ускорение подключения bluetooth девайсов

Если вы планируете пользоваться беспроводными мышью или клавиатурой, то **для уменьшения задержки при bluetooth подключении** рекомендую сразу выставить в конфиге `/etc/bluetooth/main.conf` параметр `FastConnectable` в значение `true`.

```
# /etc/bluetooth/main.conf
FastConnectable = true
```

После внесения изменений нужно перезапустить службу `bluetooth`:

```
sudo systemctl restart bluetooth
```

**Подключение bluetooth девайсов должно стать более быстрым** после включения компьютера или же после выхода из сна. Но если разницу вы не заметили, или для вас разница не критична, то лучше вернуть обратно значение `false`, т.к. включение влияет на энергопотребление, что актуально для ноутбуков. Это работает только для адаптеров, которые поддерживают это.

### Num Lock

Я привык, что в обычном состоянии на клавиатуре Num Lock включен. В i3 же он выключен. Исправить это поможет консольная программа `numlockx`. Установим ее:

```
sudo pacman -S numlockx
```

У нее всего 3 команды:

- **on** — _включить_
- **off** — _выключить_
- **toggle** — _включить если выключено, или выключить если включено._

Остается поставить включение Num Lock на автозапуск i3wm:

```
# ~/.config/i3/config
exec --no-startup-id numlockx on
```

### Шрифт

```
# Устанавливайте те шрифты, которые нравятся и подходят Вам
font pango:Ubuntu:style=Medium 10
```

### Перенос бара наверх

В секцию bar добавим строку position top, и перезапустим i3 (mod+Shift+r)

```
bar {
        position top
        status_command i3status
}
```

### Изучаем, пробуем

В одной статье невозможно описать абсолютно все. Я не затронул множество аспектов, таких как `i3status` (очень крутая штука, это кастомизируемый бар, который довольно страшненький по умолчанию), звук, подсветка клавиатуры, яркость экрана, и многое другое, чем не управляет i3 из коробки. Но он и не должен, и не позиционируется как DE. В нем мы должны настроить все сами. Кому не нравится - тому значит больше подходят полноценные DE, такие как GNOME, KDE, XCFE, и прочие (я лично переехал с Budgie). О некоторых из них поведаю в других статьях. Но основной посыл в том, что не стоит зацикливаться на первом попавшемся материале конкретного человека. Изучите дефолтный конфиг, документацию. Изучите множество мнений других людей. Берите лучшее из найденных конфигов, стройте свою уникальную систему. Не бойтесь гуглить, все скорее всего уже решено за Вас. А если нет - то есть уникальная возможность реализовать это у себя, и поведать об этом миру)


[исходник](https://igancev.ru/2020-01-05-installing-and-configuring-i3wm-on-arch-linux)